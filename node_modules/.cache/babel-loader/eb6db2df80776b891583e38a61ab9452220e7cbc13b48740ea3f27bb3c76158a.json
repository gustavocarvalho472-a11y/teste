{"ast":null,"code":"import React,{useMemo}from'react';import{Chart as ChartJS,CategoryScale,LinearScale,BarElement,Title,Tooltip,Legend}from'chart.js';import{Bar}from'react-chartjs-2';import{jsx as _jsx}from\"react/jsx-runtime\";ChartJS.register(CategoryScale,LinearScale,BarElement,Title,Tooltip,Legend);const MunicipalityComparisonChart=_ref=>{let{municipalities,metric,currentPeriod,comparisonPeriod}=_ref;const chartData=useMemo(()=>{const sortedMunicipalities=[...municipalities].sort((a,b)=>{if(metric==='executed')return b.executed-a.executed;if(metric==='deviation')return a.deviation-b.deviation;return b.reference-b.executed-(a.reference-a.executed);});const topMunicipalities=sortedMunicipalities.slice(0,10);let currentValues;let comparisonValues;let currentLabel;let comparisonLabel;if(metric==='executed'){currentValues=topMunicipalities.map(m=>m.executed);comparisonValues=topMunicipalities.map(m=>m.comparisonExecuted||0);currentLabel=\"\".concat(currentPeriod||'Atual',\" - Executado\");comparisonLabel=\"\".concat(comparisonPeriod||'Compara√ß√£o',\" \\uD83D\\uDDF3\\uFE0F - Executado\");}else if(metric==='deviation'){currentValues=topMunicipalities.map(m=>m.deviation);comparisonValues=topMunicipalities.map(m=>m.comparisonExecuted?(m.comparisonExecuted/m.reference-1)*100:0);currentLabel=\"\".concat(currentPeriod||'Atual',\" - Desvio %\");comparisonLabel=\"\".concat(comparisonPeriod||'Compara√ß√£o',\" \\uD83D\\uDDF3\\uFE0F - Desvio %\");}else{currentValues=topMunicipalities.map(m=>m.reference-m.executed);comparisonValues=topMunicipalities.map(m=>m.comparisonExecuted?m.reference-m.comparisonExecuted:0);currentLabel=\"\".concat(currentPeriod||'Atual',\" - Sobra\");comparisonLabel=\"\".concat(comparisonPeriod||'Compara√ß√£o',\" \\uD83D\\uDDF3\\uFE0F - Sobra\");}const datasets=[{label:currentLabel,data:currentValues,backgroundColor:'#10b981',borderRadius:6,borderWidth:0}];// Adicionar dataset de compara√ß√£o se houver dados\nconst hasComparisonData=comparisonValues.some(v=>v>0);if(hasComparisonData&&comparisonPeriod){datasets.push({label:comparisonLabel,data:comparisonValues,backgroundColor:'#3b82f6',borderRadius:6,borderWidth:0});}return{labels:topMunicipalities.map(m=>m.name),datasets};},[municipalities,metric,currentPeriod,comparisonPeriod]);const options={responsive:true,maintainAspectRatio:false,indexAxis:'y',plugins:{legend:{display:true,position:'bottom',labels:{font:{size:13,weight:'600'},padding:16,usePointStyle:true,boxWidth:12,boxHeight:12}},title:{display:true,text:\"Compara\\xE7\\xE3o: Top 10 Munic\\xEDpios\",font:{size:16,weight:'700'},color:'#2e3138',padding:{bottom:20}},tooltip:{callbacks:{label:function(context){const value=context.parsed.x;if(metric==='deviation'){return\"Desvio: \".concat(value.toFixed(1),\"%\");}return new Intl.NumberFormat('pt-BR',{style:'currency',currency:'BRL',notation:'compact',maximumFractionDigits:1}).format(value);}},backgroundColor:'#2e3138',padding:12,titleFont:{size:14,weight:'700'},bodyFont:{size:13}}},scales:{x:{beginAtZero:true,ticks:{callback:function(value){if(metric==='deviation'){return\"\".concat(value,\"%\");}return new Intl.NumberFormat('pt-BR',{style:'currency',currency:'BRL',notation:'compact',maximumFractionDigits:0}).format(value);},font:{size:12},color:'#6b7280'},grid:{color:'#f5edff'}},y:{ticks:{font:{size:12},color:'#6b7280'},grid:{display:false}}}};return/*#__PURE__*/_jsx(\"div\",{style:{backgroundColor:'#ffffff',borderRadius:'12px',padding:'24px',boxShadow:'0 2px 8px rgba(0, 0, 0, 0.08)',border:'1px solid #f5edff',height:'500px'},children:/*#__PURE__*/_jsx(Bar,{data:chartData,options:options})});};export default MunicipalityComparisonChart;","map":{"version":3,"names":["React","useMemo","Chart","ChartJS","CategoryScale","LinearScale","BarElement","Title","Tooltip","Legend","Bar","jsx","_jsx","register","MunicipalityComparisonChart","_ref","municipalities","metric","currentPeriod","comparisonPeriod","chartData","sortedMunicipalities","sort","a","b","executed","deviation","reference","topMunicipalities","slice","currentValues","comparisonValues","currentLabel","comparisonLabel","map","m","comparisonExecuted","concat","datasets","label","data","backgroundColor","borderRadius","borderWidth","hasComparisonData","some","v","push","labels","name","options","responsive","maintainAspectRatio","indexAxis","plugins","legend","display","position","font","size","weight","padding","usePointStyle","boxWidth","boxHeight","title","text","color","bottom","tooltip","callbacks","context","value","parsed","x","toFixed","Intl","NumberFormat","style","currency","notation","maximumFractionDigits","format","titleFont","bodyFont","scales","beginAtZero","ticks","callback","grid","y","boxShadow","border","height","children"],"sources":["/Users/gustavocarvalho/budget-dashboard/src/components/MunicipalityComparisonChart.tsx"],"sourcesContent":["import React, { useMemo } from 'react';\nimport {\n  Chart as ChartJS,\n  CategoryScale,\n  LinearScale,\n  BarElement,\n  Title,\n  Tooltip,\n  Legend,\n  ChartOptions\n} from 'chart.js';\nimport { Bar } from 'react-chartjs-2';\n\nChartJS.register(\n  CategoryScale,\n  LinearScale,\n  BarElement,\n  Title,\n  Tooltip,\n  Legend\n);\n\ninterface MunicipalityComparison {\n  name: string;\n  executed: number;\n  reference: number;\n  deviation: number;\n  comparisonExecuted?: number; // Valor executado no per√≠odo de compara√ß√£o\n}\n\ninterface MunicipalityComparisonChartProps {\n  municipalities: MunicipalityComparison[];\n  metric: 'executed' | 'deviation' | 'extra';\n  currentPeriod?: number;\n  comparisonPeriod?: number;\n}\n\nconst MunicipalityComparisonChart: React.FC<MunicipalityComparisonChartProps> = ({\n  municipalities,\n  metric,\n  currentPeriod,\n  comparisonPeriod\n}) => {\n  const chartData = useMemo(() => {\n    const sortedMunicipalities = [...municipalities].sort((a, b) => {\n      if (metric === 'executed') return b.executed - a.executed;\n      if (metric === 'deviation') return a.deviation - b.deviation;\n      return (b.reference - b.executed) - (a.reference - a.executed);\n    });\n\n    const topMunicipalities = sortedMunicipalities.slice(0, 10);\n\n    let currentValues: number[];\n    let comparisonValues: number[];\n    let currentLabel: string;\n    let comparisonLabel: string;\n\n    if (metric === 'executed') {\n      currentValues = topMunicipalities.map(m => m.executed);\n      comparisonValues = topMunicipalities.map(m => m.comparisonExecuted || 0);\n      currentLabel = `${currentPeriod || 'Atual'} - Executado`;\n      comparisonLabel = `${comparisonPeriod || 'Compara√ß√£o'} üó≥Ô∏è - Executado`;\n    } else if (metric === 'deviation') {\n      currentValues = topMunicipalities.map(m => m.deviation);\n      comparisonValues = topMunicipalities.map(m =>\n        m.comparisonExecuted ? ((m.comparisonExecuted / m.reference) - 1) * 100 : 0\n      );\n      currentLabel = `${currentPeriod || 'Atual'} - Desvio %`;\n      comparisonLabel = `${comparisonPeriod || 'Compara√ß√£o'} üó≥Ô∏è - Desvio %`;\n    } else {\n      currentValues = topMunicipalities.map(m => m.reference - m.executed);\n      comparisonValues = topMunicipalities.map(m =>\n        m.comparisonExecuted ? m.reference - m.comparisonExecuted : 0\n      );\n      currentLabel = `${currentPeriod || 'Atual'} - Sobra`;\n      comparisonLabel = `${comparisonPeriod || 'Compara√ß√£o'} üó≥Ô∏è - Sobra`;\n    }\n\n    const datasets: any[] = [\n      {\n        label: currentLabel,\n        data: currentValues,\n        backgroundColor: '#10b981',\n        borderRadius: 6,\n        borderWidth: 0\n      }\n    ];\n\n    // Adicionar dataset de compara√ß√£o se houver dados\n    const hasComparisonData = comparisonValues.some(v => v > 0);\n    if (hasComparisonData && comparisonPeriod) {\n      datasets.push({\n        label: comparisonLabel,\n        data: comparisonValues,\n        backgroundColor: '#3b82f6',\n        borderRadius: 6,\n        borderWidth: 0\n      });\n    }\n\n    return {\n      labels: topMunicipalities.map(m => m.name),\n      datasets\n    };\n  }, [municipalities, metric, currentPeriod, comparisonPeriod]);\n\n  const options: ChartOptions<'bar'> = {\n    responsive: true,\n    maintainAspectRatio: false,\n    indexAxis: 'y',\n    plugins: {\n      legend: {\n        display: true,\n        position: 'bottom',\n        labels: {\n          font: { size: 13, weight: '600' },\n          padding: 16,\n          usePointStyle: true,\n          boxWidth: 12,\n          boxHeight: 12\n        }\n      },\n      title: {\n        display: true,\n        text: `Compara√ß√£o: Top 10 Munic√≠pios`,\n        font: { size: 16, weight: '700' },\n        color: '#2e3138',\n        padding: { bottom: 20 }\n      },\n      tooltip: {\n        callbacks: {\n          label: function(context: any) {\n            const value = context.parsed.x;\n            if (metric === 'deviation') {\n              return `Desvio: ${value.toFixed(1)}%`;\n            }\n            return new Intl.NumberFormat('pt-BR', {\n              style: 'currency',\n              currency: 'BRL',\n              notation: 'compact',\n              maximumFractionDigits: 1\n            }).format(value);\n          }\n        },\n        backgroundColor: '#2e3138',\n        padding: 12,\n        titleFont: { size: 14, weight: '700' },\n        bodyFont: { size: 13 }\n      }\n    },\n    scales: {\n      x: {\n        beginAtZero: true,\n        ticks: {\n          callback: function(value) {\n            if (metric === 'deviation') {\n              return `${value}%`;\n            }\n            return new Intl.NumberFormat('pt-BR', {\n              style: 'currency',\n              currency: 'BRL',\n              notation: 'compact',\n              maximumFractionDigits: 0\n            }).format(value as number);\n          },\n          font: { size: 12 },\n          color: '#6b7280'\n        },\n        grid: { color: '#f5edff' }\n      },\n      y: {\n        ticks: {\n          font: { size: 12 },\n          color: '#6b7280'\n        },\n        grid: { display: false }\n      }\n    }\n  };\n\n  return (\n    <div style={{\n      backgroundColor: '#ffffff',\n      borderRadius: '12px',\n      padding: '24px',\n      boxShadow: '0 2px 8px rgba(0, 0, 0, 0.08)',\n      border: '1px solid #f5edff',\n      height: '500px'\n    }}>\n      <Bar data={chartData} options={options} />\n    </div>\n  );\n};\n\nexport default MunicipalityComparisonChart;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}