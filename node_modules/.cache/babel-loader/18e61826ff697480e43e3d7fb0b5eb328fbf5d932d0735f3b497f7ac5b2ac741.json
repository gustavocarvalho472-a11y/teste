{"ast":null,"code":"import React,{useMemo}from'react';import{Chart as ChartJS,LinearScale,PointElement,Tooltip,Legend}from'chart.js';import{Scatter}from'react-chartjs-2';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";ChartJS.register(LinearScale,PointElement,Tooltip,Legend);const ClusterScatterChart=_ref=>{let{clusters}=_ref;const chartData=useMemo(()=>{return{datasets:clusters.map(cluster=>({label:\"\".concat(cluster.name,\" (\").concat(cluster.points.length,\")\"),data:cluster.points.map(p=>({x:p.year,y:p.deviation})),backgroundColor:cluster.color,pointRadius:8,pointHoverRadius:12,pointBorderWidth:2,pointBorderColor:'#ffffff'}))};},[clusters]);const options={responsive:true,maintainAspectRatio:false,plugins:{legend:{position:'bottom',labels:{font:{size:13,weight:'600'},padding:16,usePointStyle:true,pointStyle:'circle'}},tooltip:{callbacks:{label:function(context){const point=clusters.flatMap(c=>c.points).find(p=>p.year===context.parsed.x&&Math.abs(p.deviation-context.parsed.y)<0.1);if(!point)return'';return[\"Ano: \".concat(point.year).concat(point.isElectionYear?' üó≥Ô∏è':''),\"Desvio: \".concat(point.deviation.toFixed(1),\"%\"),\"Execu\\xE7\\xE3o: \".concat(point.executionRate.toFixed(1),\"%\")];}},backgroundColor:'#2e3138',padding:12,titleFont:{size:14,weight:'700'},bodyFont:{size:13}}},scales:{x:{type:'linear',title:{display:true,text:'Ano',font:{size:14,weight:'600'},color:'#2e3138'},ticks:{stepSize:1,font:{size:12},color:'#6b7280'},grid:{color:'#f5edff'}},y:{title:{display:true,text:'Desvio Or√ßament√°rio (%)',font:{size:14,weight:'600'},color:'#2e3138'},ticks:{font:{size:12},color:'#6b7280',callback:function(value){return\"\".concat(value,\"%\");}},grid:{color:'#f5edff'}}}};return/*#__PURE__*/_jsxs(\"div\",{style:{backgroundColor:'#ffffff',borderRadius:'12px',padding:'24px',boxShadow:'0 2px 8px rgba(0, 0, 0, 0.08)',border:'1px solid #f5edff'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'20px'},children:[/*#__PURE__*/_jsx(\"h3\",{style:{fontSize:'18px',fontWeight:'600',color:'#2e3138',marginBottom:'8px'},children:\"\\uD83D\\uDCCA An\\xE1lise de Clusters (K-means)\"}),/*#__PURE__*/_jsx(\"p\",{style:{fontSize:'13px',color:'#6b7280',marginBottom:'16px'},children:\"Agrupamento autom\\xE1tico de anos por padr\\xE3o de comportamento or\\xE7ament\\xE1rio\"}),/*#__PURE__*/_jsx(\"div\",{style:{display:'grid',gridTemplateColumns:'repeat(auto-fit, minmax(250px, 1fr))',gap:'12px',marginBottom:'20px'},children:clusters.map(cluster=>/*#__PURE__*/_jsxs(\"div\",{style:{padding:'12px',backgroundColor:\"\".concat(cluster.color,\"15\"),border:\"2px solid \".concat(cluster.color),borderRadius:'8px'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'8px',marginBottom:'6px'},children:[/*#__PURE__*/_jsx(\"div\",{style:{width:'12px',height:'12px',borderRadius:'50%',backgroundColor:cluster.color}}),/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'14px',fontWeight:'700',color:'#2e3138'},children:cluster.name})]}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'12px',color:'#6b7280',lineHeight:'1.5'},children:cluster.description}),/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:'11px',color:'#9755fe',marginTop:'6px',fontWeight:'600'},children:[cluster.points.length,\" ano\",cluster.points.length!==1?'s':'']})]},cluster.id))})]}),/*#__PURE__*/_jsx(\"div\",{style:{height:'450px'},children:/*#__PURE__*/_jsx(Scatter,{data:chartData,options:options})}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'16px',padding:'12px',backgroundColor:'#f9f4ff',borderRadius:'6px',fontSize:'12px',color:'#5219a1',textAlign:'center'},children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Linha base (0%)\"}),\": Representa a m\\xE9dia hist\\xF3rica do or\\xE7amento\"]})]});};export default ClusterScatterChart;","map":{"version":3,"names":["React","useMemo","Chart","ChartJS","LinearScale","PointElement","Tooltip","Legend","Scatter","jsx","_jsx","jsxs","_jsxs","register","ClusterScatterChart","_ref","clusters","chartData","datasets","map","cluster","label","concat","name","points","length","data","p","x","year","y","deviation","backgroundColor","color","pointRadius","pointHoverRadius","pointBorderWidth","pointBorderColor","options","responsive","maintainAspectRatio","plugins","legend","position","labels","font","size","weight","padding","usePointStyle","pointStyle","tooltip","callbacks","context","point","flatMap","c","find","parsed","Math","abs","isElectionYear","toFixed","executionRate","titleFont","bodyFont","scales","type","title","display","text","ticks","stepSize","grid","callback","value","style","borderRadius","boxShadow","border","children","marginBottom","fontSize","fontWeight","gridTemplateColumns","gap","alignItems","width","height","lineHeight","description","marginTop","id","textAlign"],"sources":["/Users/gustavocarvalho/budget-dashboard/src/components/ClusterScatterChart.tsx"],"sourcesContent":["import React, { useMemo } from 'react';\nimport {\n  Chart as ChartJS,\n  LinearScale,\n  PointElement,\n  Tooltip,\n  Legend,\n  ChartOptions\n} from 'chart.js';\nimport { Scatter } from 'react-chartjs-2';\nimport { Cluster } from '../utils/clustering';\n\nChartJS.register(LinearScale, PointElement, Tooltip, Legend);\n\ninterface ClusterScatterChartProps {\n  clusters: Cluster[];\n}\n\nconst ClusterScatterChart: React.FC<ClusterScatterChartProps> = ({ clusters }) => {\n  const chartData = useMemo(() => {\n    return {\n      datasets: clusters.map(cluster => ({\n        label: `${cluster.name} (${cluster.points.length})`,\n        data: cluster.points.map(p => ({\n          x: p.year,\n          y: p.deviation\n        })),\n        backgroundColor: cluster.color,\n        pointRadius: 8,\n        pointHoverRadius: 12,\n        pointBorderWidth: 2,\n        pointBorderColor: '#ffffff'\n      }))\n    };\n  }, [clusters]);\n\n  const options: ChartOptions<'scatter'> = {\n    responsive: true,\n    maintainAspectRatio: false,\n    plugins: {\n      legend: {\n        position: 'bottom',\n        labels: {\n          font: {\n            size: 13,\n            weight: '600'\n          },\n          padding: 16,\n          usePointStyle: true,\n          pointStyle: 'circle'\n        }\n      },\n      tooltip: {\n        callbacks: {\n          label: function(context: any) {\n            const point = clusters\n              .flatMap(c => c.points)\n              .find(p => p.year === context.parsed.x && Math.abs(p.deviation - context.parsed.y) < 0.1);\n\n            if (!point) return '';\n\n            return [\n              `Ano: ${point.year}${point.isElectionYear ? ' üó≥Ô∏è' : ''}`,\n              `Desvio: ${point.deviation.toFixed(1)}%`,\n              `Execu√ß√£o: ${point.executionRate.toFixed(1)}%`\n            ];\n          }\n        },\n        backgroundColor: '#2e3138',\n        padding: 12,\n        titleFont: { size: 14, weight: '700' },\n        bodyFont: { size: 13 }\n      }\n    },\n    scales: {\n      x: {\n        type: 'linear',\n        title: {\n          display: true,\n          text: 'Ano',\n          font: {\n            size: 14,\n            weight: '600'\n          },\n          color: '#2e3138'\n        },\n        ticks: {\n          stepSize: 1,\n          font: { size: 12 },\n          color: '#6b7280'\n        },\n        grid: {\n          color: '#f5edff'\n        }\n      },\n      y: {\n        title: {\n          display: true,\n          text: 'Desvio Or√ßament√°rio (%)',\n          font: {\n            size: 14,\n            weight: '600'\n          },\n          color: '#2e3138'\n        },\n        ticks: {\n          font: { size: 12 },\n          color: '#6b7280',\n          callback: function(value) {\n            return `${value}%`;\n          }\n        },\n        grid: {\n          color: '#f5edff'\n        }\n      }\n    }\n  };\n\n  return (\n    <div style={{\n      backgroundColor: '#ffffff',\n      borderRadius: '12px',\n      padding: '24px',\n      boxShadow: '0 2px 8px rgba(0, 0, 0, 0.08)',\n      border: '1px solid #f5edff'\n    }}>\n      <div style={{\n        marginBottom: '20px'\n      }}>\n        <h3 style={{\n          fontSize: '18px',\n          fontWeight: '600',\n          color: '#2e3138',\n          marginBottom: '8px'\n        }}>\n          üìä An√°lise de Clusters (K-means)\n        </h3>\n        <p style={{\n          fontSize: '13px',\n          color: '#6b7280',\n          marginBottom: '16px'\n        }}>\n          Agrupamento autom√°tico de anos por padr√£o de comportamento or√ßament√°rio\n        </p>\n\n        {/* Descri√ß√£o dos Clusters */}\n        <div style={{\n          display: 'grid',\n          gridTemplateColumns: 'repeat(auto-fit, minmax(250px, 1fr))',\n          gap: '12px',\n          marginBottom: '20px'\n        }}>\n          {clusters.map(cluster => (\n            <div\n              key={cluster.id}\n              style={{\n                padding: '12px',\n                backgroundColor: `${cluster.color}15`,\n                border: `2px solid ${cluster.color}`,\n                borderRadius: '8px'\n              }}\n            >\n              <div style={{\n                display: 'flex',\n                alignItems: 'center',\n                gap: '8px',\n                marginBottom: '6px'\n              }}>\n                <div style={{\n                  width: '12px',\n                  height: '12px',\n                  borderRadius: '50%',\n                  backgroundColor: cluster.color\n                }} />\n                <span style={{\n                  fontSize: '14px',\n                  fontWeight: '700',\n                  color: '#2e3138'\n                }}>\n                  {cluster.name}\n                </span>\n              </div>\n              <div style={{\n                fontSize: '12px',\n                color: '#6b7280',\n                lineHeight: '1.5'\n              }}>\n                {cluster.description}\n              </div>\n              <div style={{\n                fontSize: '11px',\n                color: '#9755fe',\n                marginTop: '6px',\n                fontWeight: '600'\n              }}>\n                {cluster.points.length} ano{cluster.points.length !== 1 ? 's' : ''}\n              </div>\n            </div>\n          ))}\n        </div>\n      </div>\n\n      {/* Gr√°fico */}\n      <div style={{ height: '450px' }}>\n        <Scatter data={chartData} options={options} />\n      </div>\n\n      {/* Linha de refer√™ncia */}\n      <div style={{\n        marginTop: '16px',\n        padding: '12px',\n        backgroundColor: '#f9f4ff',\n        borderRadius: '6px',\n        fontSize: '12px',\n        color: '#5219a1',\n        textAlign: 'center'\n      }}>\n        <strong>Linha base (0%)</strong>: Representa a m√©dia hist√≥rica do or√ßamento\n      </div>\n    </div>\n  );\n};\n\nexport default ClusterScatterChart;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}